<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
</head>

<body>

  <div id="container">
    <video id="local" autoplay></video>

    <video id="remote" autoplay></video>

    <button id="call">call</button>
  </div>

  <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
  <script>
  	var local = document.querySelector('#local');
  	var remote = document.querySelector('#remote');
  	var configuration = null;
  	var configuration = { 
  		iceServers: [
  			{
  				urls: "stun:stun.l.google.com:19302"
  			},
  			{
  			    urls: 'turn:numb.viagenie.ca',
  			    credential: 'muazkh',
  			    username: 'webrtc@live.com'
  			}
  		]
  	};
  	var localStream;
  	var pc1;
  	var pc2;

  	document.querySelector('#call').addEventListener('click', () => {	
	  	pc1 = new RTCPeerConnection(configuration); 
		pc1.onicecandidate = event => {
			pc2.addIceCandidate(event.candidate)
		};

  		pc2 = new RTCPeerConnection(configuration);
  		pc2.onicecandidate = event => {
  			pc1.addIceCandidate(event.candidate)
  		};

  		pc2.ontrack = event => {
  			if (remote.srcObject !== event.streams[0]) {
  				remote.srcObject = event.streams[0];
  			}
  		}

  		pc1.addTrack(localStream.getTracks()[0], localStream);

  		pc1.createOffer({
  			offerToReceiveVideo: 1
  		}).then(desc => {
  			pc1.setLocalDescription(desc);
  			pc2.setRemoteDescription(desc);

  			pc2.createAnswer().then(desc => {
  				pc2.setLocalDescription(desc);
  				pc1.setRemoteDescription(desc);
  			});
  		});

  		
  	});


	navigator.mediaDevices.getUserMedia({
		audio: false,
		video: true
	}).then(stream => {
	  	local.srcObject = stream;
	  	localStream = stream;
	});

  	

  </script>
</body>
</html>